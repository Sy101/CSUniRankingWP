<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <script src="scripts.js" defer></script>
  <title>Top Computer Science Universities</title>
  <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #42b983;
      --background-color: #f5f5f5;
      --text-color: #333;
      --shadow-color: rgba(0, 0, 0, 0.1);
      --dropdown-color: #fff;
      --dropdown-info-color: #f5f5f5;
    }

    body {
      font-family: 'Comfortaa', cursive;
      margin: 0;
      padding: 0;
      background-color: var(--background-color);
      background-image: repeating-linear-gradient(transparent, transparent calc(100px - 1px), var(--primary-color) 100px),
                        repeating-linear-gradient(90deg, transparent, transparent calc(100px - 1px), var(--primary-color) 100px);
      background-size: 100px 100px;
      color: var(--text-color);
    }

    header {
      background-color: var(--primary-color);
      color: #fff;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: 0 2px 10px var(--shadow-color);
    }
    
    main {
      max-width: 1200px;  /* or whatever max width you prefer */
      margin: 0 auto;     /* centers the content horizontally */
      padding: 20px;     /* some spacing around the content for smaller screens */
    }

    #logo {
      margin-bottom: 15px;
      height: 70px;
      cursor: pointer;
    }
    
    h1 {
      margin: 0;
      font-size: 28px;
    }

    .theme-switcher {
      cursor: pointer;
      color: #fff;
      align-self: flex-end;
      margin-top: 10px;
    }
    
    .theme-switcher:hover {
      text-decoration: underline;
    }

    .search-sort-container {
      display: flex;
      justify-content: space-between;
      padding: 20px;
      background-color: var(--primary-color);
      color: var(--text-color);
    }

    #search-input {
      margin-right: 20px;
      padding: 10px;
      font-size: 16px;
      flex-grow: 1;
      border-radius: 4px;
      border: none;
      background-color: var(--dropdown-color);
      color: var(--text-color);
    }

    #sort-select, #sort-direction, #location-select {
      padding: 10px;
      font-size: 16px;
      border-radius: 4px;
      border: none;
      color: var(--text-color);
      background-color: var(--dropdown-color);
    }

    #sort-direction, #location-select {
      margin-left: 20px;
    }

    ul {
      display: flex;
      flex-direction: column;
      padding: 20px;
      list-style: none;
    }
    
    li {
      border-radius: 4px;
      box-shadow: 0 2px 4px var(--shadow-color);
      background-color: var(--background-color);
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      margin-bottom: 20px;
      will-change: transform;
    }
    
    li:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px var(--shadow-color);
    }
    
    .university-info {
      display: none;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .university-info.show {
      display: block;
      opacity: 1;
    }
    
    #search-results {
      position: absolute;
      margin-top: 2px;  /* Adjust the margin to move search results slightly below input */
      top: 100%;        /* Position results below the input */
      background-color: var(--background-color);
      border-radius: 4px;
      box-shadow: 0 2px 4px var(--shadow-color);
      max-height: 200px;
      overflow-y: auto;
      padding: 10px 0;
      width: 100%;  /* make the width same as input */
      z-index: 10;  /* Ensure it's above other elements */
    }

    .search-result-item {
      padding: 10px 20px;
      cursor: pointer;
    }

    .search-result-item:hover {
      background-color: var(--dropdown-info-color);
    }
    
    #load-more-btn {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      border: none;
      border-radius: 20px;
      background-color: var(--primary-color);
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: 0.3s;
    }

    #load-more-btn:hover {
      transform: scale(1.05);
    }

    h2 {
      font-size: 24px;
      font-weight: 500;
    }

    p, small, strong, a {
      font-size: 16px;
      line-height: 1.5;
    }

    a {
      color: var(--primary-color);
      text-decoration: none;
      transition: 0.3s;
    }
    
    .container {
        max-width: 1200px; /* you can adjust this value based on your preference */
        margin: 0 auto; /* centers the container */
        padding: 0 20px; /* optional padding */
    }
    
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>
    <a href="https://hebbian.ch" target="_blank"><img id="logo" src="https://hebbian.ch/img/main-logo.png" alt="Logo"></a>
    <h1>Top Computer Science Universities</h1>
    <span id="theme-switcher" class="theme-switcher">Switch Theme</span>
  </header>
    <main>  
      <div class="search-sort-container">
        <div style="position: relative; flex-grow: 1;">
          <input type="text" id="search-input" placeholder="Search for a university...">
          <div id="search-results" hidden></div>
        </div>
        <select id="sort-select">
          <option value="rank">Sort by Rank</option>
          <option value="score">Sort by Score</option>
          <option value="tuition">Sort by Tuition Fee</option>
        </select>
        <select id="sort-direction">
          <option value="asc">Ascending</option>
          <option value="desc">Descending</option>
        </select>
        <select id="location-select">
          <!-- Locations are dynamically filled here -->
        </select>
      </div>
      <ul id="universities"></ul>
      <button id="load-more-btn">Load more</button>
        
      </ul>
    </main>
  <script>
    var universities = [

        ];

    var originalUniversities = [...universities];
    var displayedUniversitiesCount = 20;

    function generateUniversities() {
      var universitiesList = document.getElementById('universities');
      universitiesList.innerHTML = '';

      for (var i = 0; i < displayedUniversitiesCount && i < universities.length; i++) {
        var uni = universities[i];
        
        var listItem = document.createElement('li');

        var universityOverview = document.createElement('div');
        universityOverview.innerHTML = `
          <h2>${uni[3]} <small>(${uni[4]})</small></h2>
          <p><strong>Rank:</strong> ${uni[0]} | <strong>Score:</strong> ${uni[1]} | <strong>Tuition Fee:</strong> ${"~$" + uni[2]}</p>
        `;
        universityOverview.addEventListener('click', function() {
          this.nextElementSibling.classList.toggle('show');
        });

        var universityInfo = document.createElement('div');
        universityInfo.classList.add('university-info');
        universityInfo.innerHTML = `
          <p><strong>Summary:</strong> ${uni[5]}</p>
          <p><strong>Requirements:</strong> ${uni[6]}</p>
          <a href="${uni[7]}" target="_blank">More Info</a>
        `;

        listItem.appendChild(universityOverview);
        listItem.appendChild(universityInfo);

        universitiesList.appendChild(listItem);
      }
      
      if (displayedUniversitiesCount >= universities.length) {
        document.getElementById('load-more-btn').style.display = 'none';
      } else {
        document.getElementById('load-more-btn').style.display = 'block';
      }
    }
    
    function loadMoreUniversities() {
      displayedUniversitiesCount += 20;
      generateUniversities();
    }


    function switchTheme() {
      var root = document.documentElement;
      var currentBackgroundColor = getComputedStyle(root).getPropertyValue('--background-color');

      if (currentBackgroundColor.trim() === '#333') {
        root.style.setProperty('--background-color', '#fff');
        root.style.setProperty('--text-color', '#333');
        root.style.setProperty('--shadow-color', 'rgba(0, 0, 0, 0.1)');
        root.style.setProperty('--dropdown-color', '#fff');
        root.style.setProperty('--dropdown-info-color', '#f5f5f5');
      } else {
        root.style.setProperty('--background-color', '#333');
        root.style.setProperty('--text-color', '#DDD');
        root.style.setProperty('--shadow-color', 'rgba(0, 0, 0, 0.4)');
        root.style.setProperty('--dropdown-color', '#444');
        root.style.setProperty('--dropdown-info-color', '#3B3B3B');
      }
    }

    function searchUniversities(event) {
      var searchTerm = document.getElementById('search-input').value.toLowerCase();

      if (searchTerm === '') {
        universities = [...originalUniversities];
        document.getElementById('search-results').innerHTML = '';
        document.getElementById('search-results').hidden = true;
      } else {
        universities = originalUniversities.filter(uni => uni[3].toLowerCase().includes(searchTerm));
        updateSearchResults(universities, searchTerm);
      }

      generateUniversities();
    }

    function updateSearchResults(results, searchTerm) {
      var searchResultsContainer = document.getElementById('search-results');
      searchResultsContainer.innerHTML = '';
      searchResultsContainer.hidden = false;

      for (var i = 0; i < results.length && i < 5; i++) {
        var resultItem = document.createElement('div');
        resultItem.textContent = results[i][3];
        resultItem.classList.add('search-result-item');
        resultItem.addEventListener('click', function(event) {
          document.getElementById('search-input').value = event.target.textContent;
          searchUniversities();
        });

        searchResultsContainer.appendChild(resultItem);
      }
    }

    function sortUniversities() {
      var sortKey = document.getElementById('sort-select').value;
      var sortDirection = document.getElementById('sort-direction').value;
      var sortKeyIndex;

      switch (sortKey) {
        case 'rank': sortKeyIndex = 0; break;
        case 'score': sortKeyIndex = 1; break;
        case 'tuition': sortKeyIndex = 2; break;
        default: sortKeyIndex = 0;
      }

      universities.sort((a, b) => {
        if (sortDirection === 'asc') {
          return a[sortKeyIndex] - b[sortKeyIndex];
        } else {
          return b[sortKeyIndex] - a[sortKeyIndex];
        }
      });

      generateUniversities();
    }

    function filterLocation() {
      var selectedLocation = document.getElementById('location-select').value;
      
      if (selectedLocation !== 'all') {
        universities = originalUniversities.filter(uni => uni[4].split(', ')[1] === selectedLocation); // split and compare the country
      } else {
        universities = [...originalUniversities];
      }
      
      generateUniversities();
    }

    function populateLocations() {
      var locations = [...new Set(originalUniversities.map(uni => uni[4].split(', ')[1]))]; // split and get the country
      var locationSelect = document.getElementById('location-select');
      var allOption = document.createElement('option');
      allOption.value = 'all';
      allOption.textContent = 'All';
      locationSelect.appendChild(allOption);
    
      for (var i = 0; i < locations.length; i++) {
        var locationOption = document.createElement('option');
        locationOption.value = locations[i];
        locationOption.textContent = locations[i];
        locationSelect.appendChild(locationOption);
      }
    }
    
    function hideSearchResults() {
        var searchResultsContainer = document.getElementById('search-results');
        searchResultsContainer.hidden = true;
    }
    
    function showSearchResults() {
        var searchResultsContainer = document.getElementById('search-results');
        searchResultsContainer.hidden = false;
    }

    var universityOverviews = document.querySelectorAll('.university-overview');

    universityOverviews.forEach(function(universityOverview) {
        universityOverview.addEventListener('click', function() {
            var infoElement = this.nextElementSibling;
            if (infoElement.style.display === 'none' || !infoElement.style.display) {
                infoElement.style.display = 'block';
                setTimeout(() => {
                    infoElement.classList.add('show');
                }, 50);
            } else {
                infoElement.classList.remove('show');
                setTimeout(() => {
                    infoElement.style.display = 'none';
                }, 500); // this timeout should match the CSS transition duration
            }
        });
    });
    
    window.onload = function() {
      generateUniversities();
      populateLocations();

      document.getElementById('theme-switcher').addEventListener('click', switchTheme);
      document.getElementById('search-input').addEventListener('input', searchUniversities);
      document.getElementById('sort-select').addEventListener('change', sortUniversities);
      document.getElementById('sort-direction').addEventListener('change', sortUniversities);
      document.getElementById('location-select').addEventListener('change', filterLocation);
      document.getElementById('load-more-btn').addEventListener('click', loadMoreUniversities);
      
      document.addEventListener('click', function(event) {
          var searchInput = document.getElementById('search-input');
          var searchResultsContainer = document.getElementById('search-results');
      
          // If the click is outside the search input and search results, hide the results
          if (!searchInput.contains(event.target) && !searchResultsContainer.contains(event.target)) {
              hideSearchResults();
          }
      });
      
      document.getElementById('search-input').addEventListener('focus', showSearchResults);
    }
  </script>
</body>
</html>